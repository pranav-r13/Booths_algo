<!DOCTYPE html>
<html>

<head>
  <title>BOOTHS ALGORITHM CALCULATOR</title>
  <style>

    body {
      margin: 50px;
    }

    #styling_booths {
      font-family: Helvetica;
      text-align: center;
      padding: 10px;
      width: 500px;
    }

    #styling_booths table {
      border: none;
      width: 50%;
      margin-bottom: 20px;
      margin-top: 20px;
      margin-right: 25%;
      margin-left: 25%;
      
    }

    #styling_booths td {
      padding: 10px;
    }

    #styling_booths .func_tleft {
      font-weight: bold;
      text-align: right;
      width: 25%;
    }

    #styling_booths .func_tright {
      text-align: left;
    }

    #styling_booths a {
      color: #000000;
      font-weight: bold;
      text-decoration: none;
    }

    #styling_booths a:hover {
      color: #000000;
    }

    #func_output {
      padding: 20px;
    }

    #func_output table {
      width: 60%;
      margin-left: 15%;
      margin-right: 15%;
    }

    #func_output .func_tleft {
      width: 50%;
    }

    #func_output .func_tlhead {
      color: #000000;
      width: 50%;
      font-weight: bold;
      text-align: right;
      font-size: 125%;
    }
  </style>
  <script type="text/javascript">
    window.x; window.y; window.bit; window.set;
    window.data = [];
    data.length = 7;

    window.steps = [];
    function func_print(output) {
      document.getElementById("func_output").innerHTML = output;
    }
    function func_error(messages) {
      var output = "Error</br>";
      for (i = 0; i < messages.length; i++) {
        output += messages[i] + "<br/>";
      }
      func_print(output);
    }
    function func_prettyPrint() {
      var decbin;
      if (set == 1) {
        decbin = "Binary";
      } else {
        decbin = "Decimal";
      }
      var t = "<table>";
      var te = "</table>";
      var tr = "<tr>";
      var trn = "</tr><tr>";
      var tre = "</tr>";
      var td = "<td>";
      var tdh = "<td class='func_tlhead'>";
      var tdl = "<td class='func_tleft'>";
      var tdr = "<td class='func_tright'>";
      var tde = "</td>";
      var tdn = "</td><td>";

      var out1 = "<h1>-Output-</h1>" + t;
      var r_1 = tr + tdl + "Input:" + tde + tdr + data[0] + "-bit, " + decbin + tde + tre;

      var r_2_a = tr + tdh + "Multiplicand - " + tdn + tde + trn;
      var r_2_b = tdl + "Decimal:" + tde + tdr + data[2] + tde + trn;
      var r_2_c = tdl + "Binary:" + tde + tdr + data[3] + tde + tre;

      var r_3_a = tr + tdh + "Multiplier - " + tdn + tde + trn;
      var r_3_b = tdl + "Decimal:" + tde + tdr + data[4] + tde + trn;
      var r_3_c = tdl + "Binary:" + tde + tdr + data[5] + tde + trn;
      var r_3_d = tdl + "Two's Complement:" + tde + tdr + data[6] + tde + tre;

      var r_45 = tr + trn + tdh + "Steps - " + tdn + tde;

      var r_15 = out1 + r_1 + r_2_a + r_2_b + r_2_c + r_3_a + r_3_b + r_3_c + r_3_d + r_45;

      var p = 0;
      var r_6_o = "";

      while (p < steps.length) {
        r_6_o += trn + tdl + steps[p] + tde + tdr + steps[p + 1] + tde;
        p = p + 2;
      }

      var output = r_15 + r_6_o + tre + te;

      func_print(output);
    }
    function func_dec2bin(decimal) {
      var sign;
      var binary;
      if (decimal < 0) {
        sign = 1;
        decimal = Math.abs(decimal + 1);
      } else {
        sign = 0;
      }
      binary = (decimal).toString(2);
      while (binary.length < bit) {
        binary = "0" + binary;
      }
      if (sign == 1) {
        binary = func_twosComp(binary);
      }
      return binary;
    }
    function func_twosComp(originalBinary) {
      var convertedBinary = "";
      var binary = "";
      var i;
      for (i in originalBinary) {
        if (originalBinary[i] == "0") {
          convertedBinary += "1";
        } else {
          convertedBinary += "0";
        }
      }
      return convertedBinary;
    }
    function func_boothAdd(product, multiplier) {
      var newProduct;
      var endBit = bit - 1;
      var upper = product.substring(0, bit);
      var addU = parseInt(upper, 2);
      var addM = parseInt(multiplier, 2);
      var sumD = addU + addM;
      var sumB = func_dec2bin(sumD);
      if (sumB.length > bit) {
        newProduct = sumB.slice(1) + product.slice(bit);
      } else {
        newProduct = sumB + product.slice(bit);
      }
      return newProduct;
    }
    function func_boothsAlgorithm() {
      var i;
      var mX = data[3];
      var mY = data[5];
      var product = "";
      var boothBit = 0;
      var lastBit = bit + bit - 1;
      var negmY = data[6];
      for (i = 0; i < bit; i++) {
        product += "0";
      }
      product += mX;
      steps.push("Starting Out: ");
      steps.push(product);

      for (i = 0; i < bit; i++) {
        var lastChar = product.slice(-1);
        if (lastChar > boothBit) {
          product = func_boothAdd(product, negmY);
          steps.push("Subtract: ");
          steps.push(product);
        } else if (lastChar < boothBit) {
          product = func_boothAdd(product, mY)
          steps.push("Add: ");
          steps.push(product);
        }

        boothBit = lastChar;
        product = product[0] + product;
        product = product.slice(0, -1);
        steps.push("Shift: ");
        steps.push(product);
      }

      steps.push("Final Product (Binary): ");
      steps.push(product);
      if (product[0] == "1") {
        var dec = parseInt(func_twosComp(product), 2) + 1;
        dec = 0 - dec;
      } else {
        var dec = parseInt(product, 2);
      }
      steps.push("Final Product (Decimal): ");
      steps.push(dec);
    }
    function func_verify() {
      var exp = bit - 1;
      var max = Math.pow(2, exp) - 1;
      var min = -1 * Math.pow(2, exp);
      var errors = [];
      if (set == 1) {
        errors.push("Use decimal input");
      } else {
        data[0] = bit;
        data[1] = set;
        data[2] = x;
        data[4] = y;
      }
      if (!Number.isInteger(x)) {
        errors.push("multiplicand should be integer");
      }
      if (!Number.isInteger(y)) {
        errors.push("multiplier should be integer");
      }
      if (x < min || x > max) {
        errors.push("Out of range");
      }
      if (y < min || y > max) {
        errors.push("Out of range");
      }
      if (errors.length > 0) {
        func_error(errors);
        return false;
      } else if (set == 0) {
        data[3] = func_dec2bin(x);
        data[5] = func_dec2bin(y);
        data[6] = func_dec2bin(-y);
        return true;
      } else {
        return true;
      }
    }
    function func_submit() {
      var input = document.getElementById("func_form").elements;
      var xIN = input[0].value;
      var yIN = input[1].value;
      x = parseInt(xIN, 10);
      y = parseInt(yIN, 10);
      bit = 8;
      set = 0;

      func_reset();

      if (func_verify() == true) {
        func_boothsAlgorithm();
        func_prettyPrint();
      }
    }
    function func_reset() {
      document.getElementById("func_form").reset();
      data = [];
      steps = [];
      func_print("");
    }
  </script>
</head>

<body>
  <div id="styling_booths">
    <h1>Booth's Algorithm Calculator</h1>
    <form id="func_form">
      <table>
        <tr>
          <td class="func_tleft">Multiplicand:</td>
          <td class="func_tright"><input type="text"></td>
        </tr>
        <tr>
          <td class="func_tleft">Multiplier:</td>
          <td class="func_tright"><input type="text"></td>
        </tr>
      </table>
    </form>
    <button onclick="func_submit()">Submit</button>
    <button onclick="func_reset()">Reset</button>
    <div id="func_output"></div>
  </div>
</body>

</html>